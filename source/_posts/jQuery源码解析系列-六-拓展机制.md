---
title: jQueryæºç è§£æç³»åˆ—(å…­) -æ‹“å±•æœºåˆ¶
date: 2019-04-17 07:20:18
tags: [jQuery, ts]
categories: [frontend]
---

jQueryä¸ºå¼€å‘è€…æä¾›äº†`å¿«é€Ÿä¾¿æ·`çš„DOMæ“ä½œ, é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³æ·»åŠ è‡ªå·±çš„æ–¹æ³•åˆ°jQueryåŸå‹æˆ–è€…æ„é€ å‡½æ•°ä¸Š, æˆ‘ä»¬è¯¥æ€ä¹ˆåšå‘¢? jQueryæš´éœ²å‡ºäº†`extend`APIæ¥è§£å†³è¿™ä¸ªé—®é¢˜, è¿™ç¯‡æ–‡ç« å°±æ¥è§‚æ‘©ä¸€ä¸‹å…¶`æ‹“å±•æœºåˆ¶`.


<!-- more -->


## ä¸€ã€æ›´æ–°

------

### [2019-4-21]

#### Changed

- æ”¹è¿›æ–‡ç« æ ¼å¼ğŸ‰

## äºŒã€å‰ç½®

------

#### 2.1 æ·±æ‹·è´vsæµ…æ‹·è´

> **PS**: å…³äº`æ·±`ã€`æµ…`æ‹·è´çš„çŸ¥è¯†, ç½‘ä¸Šçš„å„ç§åšå®¢å·²ç»å±‚å‡ºä¸ç©·äº†, å¯¹å…¶å®`ç°æ–¹å¼`ä»¥åŠ`åŸºæœ¬åŸç†`éƒ½è®²è§£çš„å¾ˆæ¸…æ¥š. è¿™é‡Œè¿˜æ˜¯`è‹¦å£å©†å¿ƒ`åœ°æä¸€ä¸‹, å®ƒä»¬çš„ä¸»è¦åŒºåˆ«, ä¹Ÿæ˜¯ä¸ºäº†æ¥ä¸‹æ¥åœ°é˜…è¯»ä½œä¸ªé“ºå«å§.

é‚£ä¹ˆ, é—®é¢˜æ¥äº†:

> **Q**: ä¸¤è€…çš„`ä¸»è¦`åŒºåˆ«æ˜¯ä»€ä¹ˆ?

- å¯¹äº`æ•°ç»„`, ä¸¤è€…æ˜¯ä¸€æ ·çš„åŠŸèƒ½
- å¯¹äº`é”®å€¼å¯¹å¯¹è±¡`
  - `shallowCopy`åªæ‹·è´`Object.keys()`, ä¹Ÿå°±æ˜¯ç¬¬ä¸€å±‚`é”®å€¼`
  - `deepCopy`åˆ™åä¹‹

ä¸€ä¸ªç®€å•çš„ä¾‹å­:

```js
const obj = {
  b: 1,
  c: 2,
  d: {
    e: 3,
    f: [],
    g: {
      h: {
        ...
      },
    },
  },
};

// shallowCopy: {b, c, d,}
// deepCopy: {b: 1, c: 2, d: { e: 3, f: [], g: { h: {} } }}
```

å…³äºå®ƒä»¬çš„åŒºåˆ«, è¿˜å¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰çš„æ–‡ç« :

> **PS**: [å‰ç«¯åŸºç¡€é‡æ‹¾ç³»åˆ—ä¹‹â€”â€”æ·±æµ…æ‹·è´](https://blog.yyge.top/blog/2019/03/05/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E9%87%8D%E6%8B%BE%E7%B3%BB%E5%88%97%E4%B9%8B%E2%80%94%E2%80%94%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D/)

## ä¸‰ã€ç”¨æ³•

------

### 3.1 *jQuery.extend*&j*Query.fn.extend*

jqæä¾›äº†ä¸¤ç§æ–¹å¼, ä¾›æˆ‘ä»¬è‡ªå®šä¹‰æ‹“å±•:

- jQuery.extend(...)
  - æ‹“å±•`Static`, ä¹Ÿå°±æ˜¯`é™æ€æ–¹æ³•`
- jQuery.fn.extend(...)
  - æ‹“å±•`Non-static`(**å®ä¾‹æ–¹æ³•**)

### 3.2 å¦‚ä½•ä½¿ç”¨?

åˆ†æ`æ‹“å±•æœºåˆ¶`å‰, å…ˆåšä¸€ä»¶äº‹æƒ…, é‚£å°±æ˜¯å¦‚ä½•å»ä½¿ç”¨å®ƒ, ä¿—è¯è¯´`çŸ¥å…¶æ„,æ‚Ÿå…¶ç†,å®ˆå…¶åˆ™,è·µå…¶è¡Œ`, äº†è§£äº†å®ƒæ˜¯`å¦‚ä½•ä½¿ç”¨`, å†å»`æ·±ç©¶å…¶åŸç†`, è¿™ä¹Ÿæ˜¯æˆ‘å†™æ–‡ç« çš„ä¸€è´¯åŸåˆ™.

> **PS**: è‡ªå·±ç”¨`jQuery`å¾ˆå°‘, æ‰€ä»¥å¯¹`extend`APIä¹ŸåŸºæœ¬æ²¡ç”¨è¿‡, ä½†æ˜¯è¿™å¹¶ä¸å½±å“å¯¹å…¶ç†è§£, æ¯•ç«ŸçŸ¥è¯†æ˜¯ç›¸é€šçš„, æ‰€è°“çš„æ¡†æ¶åªä¸è¿‡æ˜¯`æ¢äº†èº«çš®`.

ä¸€èˆ¬æ¥è¯´, å¼€å‘è€…å¯ä»¥æ ¹æ®`å¯ä»¥ä¼ é€’çš„å‚æ•°ä¸ªæ•°ä¸åŒ`, é€šè¿‡ä¸‹è¿°ä¸‰ç§æ–¹å¼ä½¿ç”¨(ä»¥`jQuery.fn.extend`)ä¸ºä¾‹:

#### 3.2.1 ä½¿ç”¨æ–¹å¼ä¸€

> **PS**: **ç»™jqåŸå‹æ·»åŠ æ–¹æ³•**. jQueryçš„å„ç§`plugin`å°±æ˜¯é€šè¿‡å¦‚æ­¤æ¥æŒ‚è½½

```js
$.fn.extend({
  sayHello: function() {
    // Do something
  },
});
```

è¿˜æœ‰å¦ä¸€ç§æ–¹å¼, é‚£å°±æ˜¯é€šè¿‡`ç›´æ¥èµ‹å€¼`çš„æ–¹å¼æ¥æ‹“å±•:

```js
$.fn['sayHello'] = function() {
  // Do something
};
```

#### 3.2.2 ä½¿ç”¨æ–¹å¼äºŒ

> **PS**: åˆå¹¶`åç»­`å¯¹è±¡åˆ°`é¦–ä¸ª`å¯¹è±¡, çº¯ç²¹è¿”å›ä¸€ä¸ªæ‹“å±•åçš„å¯¹è±¡, æ­¤æ—¶ä¸`jQuery`æ²¡æœ‰ä»»ä½•å…³ç³».

```js
const origin = {};

const newOrigin = $.fn.extend(origin, { name: '' });
```

#### 3.2.3 ä½¿ç”¨æ–¹å¼ä¸‰

> **PS**: æ˜¯å¦æ‰§è¡Œæ·±å±‚çš„`copy`æ“ä½œ.

```js
const origin = {};

const newOrigin = $.fn.extend(true, origin, {
  name: 'duan',
  skill: {
    hobby: {
      favorite: {},
    },
  },
});

// { xxx, skill: { hobby: { favorite: {} } } }
```

## å››ã€ç»†è¯´

------

> **PS**: å¯¹äºå†…éƒ¨çš„å…¨éƒ¨ä»£ç é€»è¾‘, æˆ‘è§‰å¾—å¹¶æ²¡æœ‰å¿…è¦ç»†çœ‹, æ‰€ä»¥è¿™é‡Œåªé€‰å–äº†ä¸€ç§æƒ…å†µâ€”â€”â€”â€”`å•ä¸ªå‚æ•°`, ä¹Ÿå°±æ˜¯å¯¹äºæ‹“å±•`jQueryåŸå‹`or`é™æ€æ–¹æ³•`çš„å¤„ç†.

### 4.1 è´´æºç 

å…ˆæ¥è´´ä¸€ä¸‹éƒ¨åˆ†æºç :

```js
jQuery.extend = jQuery.fn.extend = function() {
  var target = arguments[0] || {};
  var i;
  var option;
  var length = arguments.length;
  var name;
  var src;
  var copy;

  // *åŸæ–‡æ³¨é‡Š*: Extend jQuery itself if only one arguments is passed
  // *äººè¯*: åªä¼ é€’ä¸€ä¸ªå‚æ•°æ—¶, æ‹“å±•jQueryé™æ€æ–¹æ³•æˆ–å®ä¾‹æ–¹æ³•
  if(i === length) {
    target = this;
    i--;
  }

  // æ‹·è´
  for(; i < length; i++) {
    options = arguments[i];

    for(name in options) {
      copy = options[name];

      if(copy !== undefined) {
        target[name] = copy;
      }
    }
  }
}
```

### 4.2 ææºç 

å¯¹äºå•ä¸ªå‚æ•°çš„å¤„ç†é€»è¾‘å¾ˆç®€å•:

- å°†`target`èµ‹å€¼ä¸ºthis, thisæœ‰ä¸¤ç§æƒ…å†µ
  - jQueryæ„é€ å‡½æ•°
  - jQueryå®ä¾‹
- `for-in`éå†`options`
- ç»™`target`èµ‹å€¼
  - è¿‡æ»¤æ‰`target`çš„å€¼ä¸º`undefined`çš„æƒ…å†µ

## äº”ã€æ€»ç»“

------

jQueryæä¾›çš„`extend`æå¤§åœ°æ–¹ä¾¿äº†å¼€å‘è€…, åŒæ ·çš„, `var`æ¡†æ¶åŒæ ·æœ‰å¯¹åº”çš„æ‹“å±•æ–¹æ³•, è¿™é‡Œå°±ä¸è¯´äº†(**å…¶å®æ˜¯å¤ªèœäº†**).

å½“ç„¶, æœ€è¿‘ä¹Ÿåœ¨æŒ¤æ—¶é—´çœ‹`react`æºç , æ„Ÿè§‰å…¶å¤æ‚åº¦é«˜äº†å‡ ä¸ªå±‚çº§, æ‰€ä»¥è¿˜æ˜¯ä¸€æ­¥ä¸€æ­¥åœ°èµ°ä¸‹å»å§!

## äº”ã€ç¤ºä¾‹ä»£ç 

------

ä½¿ç”¨`ts`é‡æ„äº†æˆ‘ä¹‹å‰å†™çš„`jQueryç±»åº“`, é¡¹ç›®åœ°å€[æˆ³è¿™é‡Œ](https://github.com/ddzy/my-simple-jquery)